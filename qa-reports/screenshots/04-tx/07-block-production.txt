ÂçÄÂ°äÁîüÁî¢
‰∫§ÊòìÊµÅÁ®ãË∑ØÂæë
Step 7/9
Mark as read
‚Üê Ë®òÊÜ∂Ê±†
ÂÖ±Ë≠òËàáÊúÄÁµÇÊÄß ‚Üí
ÂçÄÂ°äÁîüÁî¢
Section titled ‚ÄúÂçÄÂ°äÁîüÁî¢‚Äù
Ê¶ÇËø∞
Section titled ‚ÄúÊ¶ÇËø∞‚Äù

Âú® PoS Ethereum ‰∏≠ÔºåBeacon Chain ÈÄèÈÅé RANDAO ÂÅΩÈö®Ê©üÊ©üÂà∂ÁÇ∫ÊØèÂÄã slotÔºà12 ÁßíÔºâÈÅ∏Âá∫‰∏ÄÂÄã ProposerÔºàÈ©óË≠âËÄÖÔºâ„ÄÇProposer Âæû Ë®òÊÜ∂Ê±† ÊåëÈÅ∏‰∫§ÊòìÔºåÂú® EVM ‰∏≠Âü∑Ë°åÔºåÁµÑË£ùÂá∫ÂÆåÊï¥ÁöÑÂçÄÂ°äÔºàÂåÖÂê´ execution payload Âíå consensus Ë≥áÊñôÔºâÔºåÁÑ∂ÂæåÂª£Êí≠Áµ¶Á∂≤Ë∑ØÈÄ≤Ë°å ÂÖ±Ë≠òÊäïÁ•®„ÄÇ

Ê†∏ÂøÉÂéüÁêÜ
Section titled ‚ÄúÊ†∏ÂøÉÂéüÁêÜ‚Äù
Slot Ëàá Epoch
Section titled ‚ÄúSlot Ëàá Epoch‚Äù
Ê¶ÇÂøµ	ÂÆöÁæ©
Slot	12 ÁßíÔºåÂçÄÂ°äÁîüÁî¢ÁöÑÊúÄÂ∞èÊôÇÈñìÂñÆ‰Ωç
Epoch	32 slots = 384 ÁßíÔºà6.4 ÂàÜÈêòÔºâ

ÊØèÂÄã slot Êúâ‰∏ÄÂÄã proposer Âíå‰∏ÄÂÄã committeeÔºàË≤†Ë≤¨ attestationÔºâ„ÄÇProposer Âú® slot ÈñãÂßãÊôÇÊúâ 4 ÁßíÁöÑÁ™óÂè£Âª£Êí≠ÂçÄÂ°ä„ÄÇ

Proposer ÈÅ∏Êìá
Section titled ‚ÄúProposer ÈÅ∏Êìá‚Äù

Proposer ÈÅ∏ÊìáÂü∫Êñº RANDAO Ê∑∑ÂêàÂÄºÔºàpseudo-randomÔºâÔºö

ÊØèÂÄã epoch ÈñãÂßãÂâçÔºåÁî®Ââç‰∏ÄÂÄã epoch ÁöÑ RANDAO mix Ë®àÁÆó proposer ÊéíÁ®ã
ÈÅ∏ÊìáÊ©üÁéáËàáÈ©óË≠âËÄÖÁöÑÊúâÊïàÈ§òÈ°çÊàêÊ≠£ÊØîÔºàÊúÄÈ´ò 32 ETHÔºâ
ÂÖ∑È´îÁÆóÊ≥ïÔºöÂ∞á RANDAO seed Âíå slot ÂÅö hashÔºåÁµêÂêàÈ©óË≠âËÄÖÈõÜÂêàÁöÑ shuffle ÁµêÊûú

proposerIndex
=
computeProposerIndex
(
state
,
epoch
,
seed
)
proposerIndex=computeProposerIndex(state,epoch,seed)

RANDAO seed Êú¨Ë∫´‰æÜËá™È©óË≠âËÄÖÂú®Âá∫Â°äÊôÇÊèê‰∫§ÁöÑ BLS Á∞ΩÁ´†ÔºàBLS SignaturesÔºâÔºåÊØèÂÄã epoch Á¥ØÁ©çÊõ¥Êñ∞„ÄÇ

ÂçÄÂ°äÁµÑË£ùÊµÅÁ®ã
Section titled ‚ÄúÂçÄÂ°äÁµÑË£ùÊµÅÁ®ã‚Äù
1. Proposer Ë¢´ÈÅ∏‰∏≠
      ‚îÇ
2. Âæû mempool ÊåëÈÅ∏‰∫§Êòì
      ‚îÇ  ‚îú‚îÄ‚îÄ Êåâ effective gas price ÊéíÂ∫è
      ‚îÇ  ‚îú‚îÄ‚îÄ ‰æùÂ∫èÂú® EVM ‰∏≠Âü∑Ë°å
      ‚îÇ  ‚îî‚îÄ‚îÄ Á¥ØË®à gas ‰∏çË∂ÖÈÅé block gas limit (30M)
      ‚îÇ
3. Ë®àÁÆó execution payload
      ‚îÇ  ‚îú‚îÄ‚îÄ state rootÔºàMerkle Patricia Trie Ê†πÈõúÊπäÔºâ
      ‚îÇ  ‚îú‚îÄ‚îÄ receipts root
      ‚îÇ  ‚îú‚îÄ‚îÄ logs bloomÔºàBloom FilterÔºâ
      ‚îÇ  ‚îî‚îÄ‚îÄ ÂÖ∂‰ªñ header Ê¨Ñ‰Ωç
      ‚îÇ
4. ÁµÑË£ù Beacon Block
      ‚îÇ  ‚îú‚îÄ‚îÄ slot, proposer_index
      ‚îÇ  ‚îú‚îÄ‚îÄ parent_rootÔºàÂâç‰∏ÄÂçÄÂ°äÊ†πÔºâ
      ‚îÇ  ‚îú‚îÄ‚îÄ state_rootÔºàBeacon stateÔºâ
      ‚îÇ  ‚îú‚îÄ‚îÄ body: attestations, deposits, execution_payload...
      ‚îÇ  ‚îî‚îÄ‚îÄ RANDAO revealÔºàBLS Á∞ΩÁ´†Ôºâ
      ‚îÇ
5. Á∞ΩÁΩ≤‰∏¶Âª£Êí≠
Execution Payload
Section titled ‚ÄúExecution Payload‚Äù

Post-Merge ÂæåÔºåÂçÄÂ°äÂàÜÁÇ∫ÂÖ©Â±§Ôºö

Consensus layerÔºàBeacon BlockÔºâÔºö

slot„ÄÅproposer_index
attestations„ÄÅslashings„ÄÅdeposits
RANDAO reveal
execution_payload

Execution layerÔºàExecution PayloadÔºâÔºö

parentHash„ÄÅfeeRecipient„ÄÅstateRoot
receiptsRoot„ÄÅlogsBloom
baseFeePerGas„ÄÅgasLimit„ÄÅgasUsed
timestamp„ÄÅextraData
transactions[]ÔºàÂ∑≤Â∫èÂàóÂåñÁöÑ‰∫§ÊòìÂàóË°®Ôºâ
Block Gas Limit
Section titled ‚ÄúBlock Gas Limit‚Äù
ÂèÉÊï∏	ÂÄº
Target	15,000,000 gas
Maximum	30,000,000 gas
baseFee Ë™øÊï¥	ÂçÄÂ°ä gas > target ‚Üí baseFee ‰∏äÂçáÔºõ< target ‚Üí ‰∏ãÈôç

baseFee ÁöÑË™øÊï¥ÂÖ¨ÂºèÔºàEIP-1559 Ë≤ªÁî®Â∏ÇÂ†¥ÔºâÔºö

baseFee
ùëõ
+
1
=
baseFee
ùëõ
√ó
(
1
+
1
8
√ó
gasUsed
ùëõ
‚àí
target
target
)
baseFee
n+1
	‚Äã

=baseFee
n
	‚Äã

√ó(1+
8
1
	‚Äã

√ó
target
gasUsed
n
	‚Äã

‚àítarget
	‚Äã

)

ÊØèÂÄãÂçÄÂ°ä baseFee ÊúÄÂ§öËÆäÂãï 12.5%„ÄÇ

PBSÔºàProposer-Builder SeparationÔºâ
Section titled ‚ÄúPBSÔºàProposer-Builder SeparationÔºâ‚Äù

ÁõÆÂâç Ethereum ÂØ¶Âãô‰∏äÊé°Áî® MEV-Boost ÂØ¶ÁèæÁöÑ PBSÔºö

Searcher ‚Üí Bundle ‚Üí Builder ‚Üí Relay ‚Üí Proposer
Builder Âæû searcher Êî∂ÈõÜ bundle Âíå mempool ‰∫§ÊòìÔºåÁµÑË£ùÊúÄÈ´òÂÉπÂÄºÂçÄÂ°ä
Relay È©óË≠â builder ÁöÑÂçÄÂ°äÊúâÊïàÊÄßÔºåÂÅöÁÇ∫ÂèØ‰ø°‰∏≠‰ªã
Proposer Êî∂Âà∞Â§öÂÄã builder ÁöÑÂá∫ÂÉπÔºåÈÅ∏ÊìáÊúÄÈ´òÂÉπÁöÑÂçÄÂ°äÈ†≠Á∞ΩÂêç
Proposer Á∞ΩÂêçÂæåÔºårelay ÊâçÊè≠Èú≤ÂÆåÊï¥ÂçÄÂ°äÂÖßÂÆπ

Proposer ‰∏çÈúÄË¶ÅËá™Â∑±ÁµÑË£ùÂçÄÂ°äÔºåÂè™ÈúÄÈÅ∏ÊìáÂíåÁ∞ΩÂêçÔºåÈôç‰Ωé‰∫ÜÈÅãË°åË§áÈõú MEV Á≠ñÁï•ÁöÑÈñÄÊ™ª„ÄÇ

Âú® Ethereum ‰∏≠ÁöÑÊáâÁî®
Section titled ‚ÄúÂú® Ethereum ‰∏≠ÁöÑÊáâÁî®‚Äù
‰∫§ÊòìÊéíÂ∫èÔºö‰∫§ÊòìÂú®ÂçÄÂ°ä‰∏≠ÁöÑÈ†ÜÂ∫èÁõ¥Êé•ÂΩ±ÈüøÂü∑Ë°åÁµêÊûúÔºàMEVÔºâ
Bloom FilterÔºölogsBloom ËÆìËºïÂÆ¢Êà∂Á´ØÂø´ÈÄüÈÅéÊøæÁõ∏Èóú‰∫§Êòì
WithdrawalsÔºöPoS ÂæåÂçÄÂ°äÂåÖÂê´È©óË≠âËÄÖÊèêÊ¨æÊìç‰Ωú
Blob ‰∫§ÊòìÔºöEIP-4844 ÁöÑ blob sidecar Âíå execution payload ÂàÜÈñãËôïÁêÜ
Á®ãÂºèÁ¢ºÁØÑ‰æã
Section titled ‚ÄúÁ®ãÂºèÁ¢ºÁØÑ‰æã‚Äù
import { ethers } from 'ethers';


const provider = new ethers.JsonRpcProvider('http://localhost:8545');


// --- 1. Êü•ÁúãÊúÄÊñ∞ÂçÄÂ°ä ---
const block = await provider.getBlock('latest', true); // true = ÂåÖÂê´‰∫§Êòì
console.log('Block Number:', block.number);
console.log('Proposer (miner):', block.miner); // PoS ÂæåÁÇ∫ fee recipient
console.log('Gas Used:', block.gasUsed.toString());
console.log('Gas Limit:', block.gasLimit.toString());
console.log('Base Fee:', ethers.formatUnits(block.baseFeePerGas, 'gwei'), 'gwei');
console.log('TX Count:', block.transactions.length);


// --- 2. ÂàÜÊûêÂçÄÂ°ä‰∏≠ÁöÑ‰∫§ÊòìÊéíÂ∫è ---
const fullBlock = await provider.getBlock(block.number, true);
for (const tx of fullBlock.prefetchedTransactions) {
  const effectiveGasPrice = tx.type === 2
    ? (block.baseFeePerGas + tx.maxPriorityFeePerGas > tx.maxFeePerGas
        ? tx.maxFeePerGas
        : block.baseFeePerGas + tx.maxPriorityFeePerGas)
    : tx.gasPrice;
  console.log(`  ${tx.hash.slice(0, 10)} | ${ethers.formatUnits(effectiveGasPrice, 'gwei')} gwei`);
}


// --- 3. ËøΩËπ§ baseFee Ë∂®Âã¢ ---
async function trackBaseFee(numBlocks) {
  const latest = await provider.getBlockNumber();
  const results = [];
  for (let i = 0; i < numBlocks; i++) {
    const b = await provider.getBlock(latest - i);
    results.push({
      number: b.number,
      baseFee: ethers.formatUnits(b.baseFeePerGas, 'gwei'),
      gasUsed: b.gasUsed.toString(),
      utilization: ((Number(b.gasUsed) / Number(b.gasLimit)) * 100).toFixed(1) + '%',
    });
  }
  console.table(results.reverse());
}
await trackBaseFee(10);


// --- 4. Êü•Áúã Beacon Chain Ë≥áË®äÔºàÈúÄË¶Å Beacon APIÔºâ ---
// const beaconUrl = 'http://localhost:5052';
// const headResponse = await fetch(`${beaconUrl}/eth/v1/beacon/headers/head`);
// const headData = await headResponse.json();
// console.log('Slot:', headData.data.header.message.slot);
// console.log('Proposer:', headData.data.header.message.proposer_index);
Áõ∏ÈóúÊ¶ÇÂøµ
Section titled ‚ÄúÁõ∏ÈóúÊ¶ÇÂøµ‚Äù
‰∫§ÊòìÁîüÂëΩÈÄ±Êúü - Êú¨Á≠ÜË®òÊòØÊµÅÁ®ãÁ¨¨ÂÖ≠Ê≠•
Ë®òÊÜ∂Ê±† - ÊµÅÁ®ã‰∏ä‰∏ÄÊ≠•Ôºö‰∫§ÊòìÂú®Ê≠§Á≠âÂæÖÊâìÂåÖ
ÂÖ±Ë≠òËàáÊúÄÁµÇÊÄß - ÊµÅÁ®ã‰∏ã‰∏ÄÊ≠•ÔºöÈ©óË≠âËÄÖÂ∞çÂçÄÂ°äÊäïÁ•®
Beacon Chain - ÂÖ±Ë≠òÂ±§ÂçîË™ø proposer ÈÅ∏Êìá
RANDAO - Proposer ÈÅ∏ÊìáÁöÑÈö®Ê©üÊï∏‰æÜÊ∫ê
Validators - È©óË≠âËÄÖËßíËâ≤
BLS Signatures - RANDAO reveal ‰ΩøÁî® BLS Á∞ΩÁ´†
ÂçÄÂ°äÁµêÊßã - ÂÆåÊï¥ÁöÑÂçÄÂ°äÊ†ºÂºèÂÆöÁæ©
ÂçÄÂ°ä Header - Header ÂêÑÊ¨Ñ‰ΩçË™™Êòé
EIP-1559 Ë≤ªÁî®Â∏ÇÂ†¥ - baseFee Ë™øÊï¥Ê©üÂà∂
Bloom Filter - logsBloom Ê¨Ñ‰Ωç
‰∏ä‰∏ÄÈ°µ
Ë®òÊÜ∂Ê±†
‰∏ã‰∏ÄÈ°µ
ÂÖ±Ë≠òËàáÊúÄÁµÇÊÄß